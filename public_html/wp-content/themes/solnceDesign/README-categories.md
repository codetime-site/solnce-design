# Система категорий с фильтрацией

Этот набор файлов добавляет расширенную функциональность для работы с категориями в WordPress, включая фильтрацию, иерархию и поиск.

## Новые файлы

### 1. `category-filtered.php`
**Шаблон страницы:** "Category Filtered Page"

Страница со списком всех категорий и возможностью фильтрации по родительским категориям и подкатегориям.

**Возможности:**
- Отображение всех категорий с изображениями
- Фильтрация по родительским категориям
- Фильтрация по подкатегориям
- Показ иерархии (родитель → дочерняя)
- Адаптивный дизайн
- Сброс фильтров

**Использование:**
1. Создайте новую страницу в WordPress
2. Выберите шаблон "Category Filtered Page"
3. Опубликуйте страницу

### 2. `category-with-products-filter.php`
**Шаблон страницы:** "Category with Products Filter"

Страница категории с фильтрацией товаров/постов внутри категории.

**Возможности:**
- Фильтрация по цене (диапазоны)
- Сортировка по названию, цене, дате
- Поиск по названию товара
- Отображение товаров в виде сетки
- Пагинация
- Адаптивный дизайн

**Использование:**
1. Создайте новую страницу в WordPress
2. Выберите шаблон "Category with Products Filter"
3. Опубликуйте страницу

### 3. `category-hierarchy.php`
**Шаблон страницы:** "Category Hierarchy Page"

Страница с иерархическим отображением категорий и модальным окном для подкатегорий.

**Возможности:**
- Иерархическое отображение категорий
- Модальное окно с подкатегориями
- AJAX загрузка подкатегорий
- Навигация по уровням
- Адаптивный дизайн

**Использование:**
1. Создайте новую страницу в WordPress
2. Выберите шаблон "Category Hierarchy Page"
3. Опубликуйте страницу

### 4. `category-functions.php`
Дополнительные функции для работы с категориями.

**Функции:**
- `get_category_hierarchy()` - получение иерархии категорий
- `custom_category_breadcrumbs()` - хлебные крошки для категорий
- `get_category_stats()` - статистика категории
- `search_categories()` - поиск категорий
- `get_popular_categories()` - популярные категории
- `get_random_categories()` - случайные категории
- `get_categories_with_images()` - категории с изображениями
- `render_category_tree()` - дерево категорий в HTML

**Шорткоды:**
- `[category_tree parent="0" level="3"]` - дерево категорий
- `[popular_categories limit="5"]` - популярные категории

## Настройка

### 1. Подключение функций
Файл `category-functions.php` автоматически подключается в `functions.php`.

### 2. Поля ACF
Для корректной работы с изображениями категорий необходимо создать поле ACF:
- **Тип поля:** Image
- **Имя поля:** img
- **Расположение:** Taxonomy Term = Category

### 3. Поля ACF для товаров
Для фильтрации по цене создайте поле ACF для постов:
- **Тип поля:** Number
- **Имя поля:** price
- **Расположение:** Post Type = Post

## Стили

Все необходимые стили включены в файлы шаблонов. Стили адаптивны и работают на всех устройствах.

## JavaScript

JavaScript код включен в файлы шаблонов и обеспечивает:
- Фильтрацию категорий
- AJAX загрузку подкатегорий
- Сортировку товаров
- Поиск по названию

## Совместимость

- WordPress 5.0+
- PHP 7.4+
- Advanced Custom Fields (ACF)
- Совместимо с существующими шаблонами

## Примеры использования

### Отображение дерева категорий в виджете
```php
echo do_shortcode('[category_tree parent="0" level="2"]');
```

### Получение популярных категорий
```php
$popular = get_popular_categories(5);
foreach ($popular as $category) {
    echo '<a href="' . $category['link'] . '">' . $category['name'] . '</a>';
}
```

### Поиск категорий
```php
$results = search_categories('мебель');
foreach ($results as $category) {
    echo '<a href="' . $category['link'] . '">' . $category['name'] . '</a>';
}
```

## Поддержка

Все файлы созданы как дополнительные к существующему коду и не изменяют оригинальные файлы темы. При необходимости можно легко удалить или отключить любую функциональность.
